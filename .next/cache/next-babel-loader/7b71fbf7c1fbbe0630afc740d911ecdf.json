{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  query getStore{ \\n    scriptTags(first: 5) {\\n      edges {\\n          node {\\n              id\\n              src\\n              displayScope\\n          }\\n      }\\n  }\\n\\n    shop { \\n      myshopifyDomain \\n    }      \\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation scriptTagCreate($input: ScriptTagInput!) {\\n        scriptTagCreate(input: $input) {\\n           scriptTag {\\n             id\\n            }\\n           userErrors {\\n            field\\n            message\\n            }\\n        }\\n    }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { Button, Card, Layout, Page, Stack, TextField, Banner, Frame, Toast } from '@shopify/polaris';\nimport gql from 'graphql-tag';\nimport React, { useState, useCallback } from 'react';\nimport { useQuery, useMutation } from '@apollo/react-hooks';\nimport axios from 'axios';\nimport Cookies from 'js-cookie';\nvar CREATE_SCRIPTTAG = gql(_templateObject());\nvar GET_STORE = gql(_templateObject2());\nvar urlScriptTags = \"https://0fb87c6bfac1.ngrok.io/test-script.js\";\n\nfunction AnnotatedLayout() {\n  _s();\n\n  var _useMutation = useMutation(CREATE_SCRIPTTAG),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      createScripts = _useMutation2[0];\n\n  var _useState = useState(false),\n      idset = _useState[0],\n      setId = _useState[1];\n\n  var _useState2 = useState(true),\n      stop = _useState2[0],\n      setStop = _useState2[1];\n\n  var _useState3 = useState(''),\n      textFieldValue = _useState3[0],\n      setTextFieldValue = _useState3[1];\n\n  var _useState4 = useState(''),\n      textFieldValueOld = _useState4[0],\n      setTextFieldValueOld = _useState4[1];\n\n  var _useState5 = useState(''),\n      textFieldValue1 = _useState5[0],\n      setTextFieldValue1 = _useState5[1];\n\n  var _useState6 = useState(''),\n      textFieldValueOld1 = _useState6[0],\n      setTextFieldValueOld1 = _useState6[1];\n\n  var _useQuery = useQuery(GET_STORE),\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      data = _useQuery.data;\n\n  var _useState7 = useState(true),\n      first = _useState7[0],\n      setFirst = _useState7[1];\n\n  var handleTextFieldChange = useCallback(function (value) {\n    if (/^\\d+$/.test(value) || value == '') setTextFieldValue(value); //console.log(textFieldValue);\n  }, []);\n  var handleTextFieldChange1 = useCallback(function (value) {\n    if (/^\\d+$/.test(value) || value == '') setTextFieldValue1(value); //console.log(textFieldValue1);\n  }, []); //toast\n\n  var _useState8 = useState(false),\n      active = _useState8[0],\n      setActive = _useState8[1];\n\n  var toastMarkup = active ? __jsx(\"div\", {\n    style: {\n      zIndex: '999'\n    }\n  }, __jsx(Toast, {\n    content: \"Settings Saved\",\n    onDismiss: function onDismiss() {\n      setActive(!active);\n    }\n  })) : null;\n  if (loading) return __jsx(\"div\", null, \"Loading..\");else if (error) {\n    //console.log(Cookies.get(\"shopOrigin\"));\n    //location.replace(`https://discord-shopify-app.herokuapp.com/auth?shop=${Cookies.get(\"shopOrigin\")}`)\n    return __jsx(\"div\", null, error.message);\n  } // console.log(data.priceRules.edges[0].node.discountCodes.edges[0].node.id);\n  // console.log(data.priceRules.edges[0].node.discountCodes.edges[0].node.code);\n  //console.log(Cookie.get(\"shopOrigin\"))\n\n  var sURL = String(data.shop.myshopifyDomain).substr(0, String(data.shop.myshopifyDomain).length - 14);\n\n  if (first) {\n    axios.get(\"/api/discordID/\".concat(sURL)).then(function (result) {\n      if (result.data.data.serverID != null) {\n        setId(true);\n        setTextFieldValue(result.data.data.serverID);\n        setTextFieldValue1(result.data.data.channelID);\n        setTextFieldValueOld(result.data.data.serverID);\n        setTextFieldValueOld1(result.data.data.channelID);\n      }\n    })[\"catch\"](function (error) {\n      return console.log(error);\n    });\n    setFirst(false);\n  }\n\n  if (stop && data.scriptTags.edges[0] == undefined) {\n    console.log(\"dublu cacat\");\n    setStop(false);\n    createScripts({\n      variables: {\n        input: {\n          src: urlScriptTags,\n          displayScope: \"ALL\"\n        }\n      },\n      refetchQueries: [{\n        query: GET_STORE\n      }]\n    });\n  }\n\n  return __jsx(Frame, null, __jsx(Page, {\n    title: \"Discordify Server/Channel ID\"\n  }, __jsx(Layout, null, toastMarkup, __jsx(Layout.Section, null, __jsx(Banner, {\n    status: idset ? \"success\" : \"critical\",\n    title: idset ? \"Server/Channel ID Set\" : \"No Server/Channel ID Set\"\n  })), __jsx(Layout.AnnotatedSection, {\n    title: \"Step One\",\n    description: __jsx(\"p\", null, \"Add Widgetbot to your server \", __jsx(\"a\", {\n      href: \"https://discord.com/oauth2/authorize?client_id=543225764036870167&scope=bot&permissions=537218112\",\n      target: \"_blank\"\n    }, __jsx(\"b\", null, \"here\")), \". Make sure you give Widgetbot all the permissions!\")\n  }, __jsx(Card, {\n    sectioned: true\n  }, __jsx(\"img\", {\n    src: \"dis1.PNG\",\n    width: \"100%\",\n    height: \"410\"\n  }))), __jsx(Layout.AnnotatedSection, {\n    title: \"Step Two\",\n    description: \"Type the ??guestmode command if you want people who don't have a discord account or are not already in your server to be able to choose a name on spot and write messages. Type ??help for a full list of commands.\"\n  }, __jsx(Card, {\n    sectioned: true\n  }, __jsx(\"img\", {\n    src: \"dis2.PNG\",\n    width: \"100%\",\n    height: \"410\"\n  }))), __jsx(Layout.AnnotatedSection, {\n    title: \"Step Three\",\n    description: \"Type the ??crate command in the text channel you want to display in the widget after it loads. Copy the values from Server and Channel without the quotes, paste them bellow and submit. You can always come back here to change the IDs\"\n  }, __jsx(Card, {\n    sectioned: true\n  }, __jsx(\"img\", {\n    src: \"dis3.PNG\",\n    width: \"100%\",\n    height: \"410\"\n  }))), __jsx(Layout.Section, null, __jsx(Card, {\n    sectioned: true\n  }, __jsx(Stack, {\n    spacing: \"extraLoose\"\n  }, __jsx(Stack.Item, {\n    fill: true\n  }, __jsx(TextField, {\n    label: \"Server ID\",\n    placeholder: \"Paste your Discord Server ID here\",\n    value: textFieldValue,\n    onChange: handleTextFieldChange\n  }))), __jsx(\"br\", null), __jsx(Stack, {\n    spacing: \"extraLoose\"\n  }, __jsx(Stack.Item, {\n    fill: true\n  }, __jsx(TextField, {\n    label: \"Channel ID\",\n    placeholder: \"Paste your Discord Channel ID here\",\n    value: textFieldValue1,\n    onChange: handleTextFieldChange1\n  }))), __jsx(\"br\", null), __jsx(Stack, {\n    distribution: \"trailing\"\n  }, __jsx(Button, {\n    primary: true,\n    disabled: (textFieldValue == '' || textFieldValueOld == textFieldValue) && (textFieldValue1 == '' || textFieldValueOld1 == textFieldValue1) ? true : false,\n    type: \"submit\",\n    onClick: function onClick() {\n      if (textFieldValue != '') {\n        setId(true);\n        setActive(true);\n        makeApiCall({\n          serverID: textFieldValue,\n          channelID: textFieldValue1\n        }, sURL);\n      } else {\n        alert(\"Please paste in your ID first\");\n      }\n    }\n  }, \"Submit\")))))));\n\n  function makeApiCall(_x, _x2) {\n    return _makeApiCall.apply(this, arguments);\n  }\n\n  function _makeApiCall() {\n    _makeApiCall = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(appInfo, sURL) {\n      var url;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              url = \"/api/discordID/\".concat(sURL);\n              setTextFieldValueOld(textFieldValue);\n              setTextFieldValueOld1(textFieldValue1);\n              axios.post(url, appInfo).then(function (result) {})[\"catch\"](function (error) {\n                console.log(error.response);\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _makeApiCall.apply(this, arguments);\n  }\n}\n\n_s(AnnotatedLayout, \"7Cx86xppq4hHEx4379Ue1UvvTJ4=\", false, function () {\n  return [useMutation, useQuery];\n});\n\n_c = AnnotatedLayout;\nexport default AnnotatedLayout;\n\nvar _c;\n\n$RefreshReg$(_c, \"AnnotatedLayout\");","map":{"version":3,"sources":["D:/MyProjects/discord-app/pages/index.js"],"names":["Button","Card","Layout","Page","Stack","TextField","Banner","Frame","Toast","gql","React","useState","useCallback","useQuery","useMutation","axios","Cookies","CREATE_SCRIPTTAG","GET_STORE","urlScriptTags","AnnotatedLayout","createScripts","idset","setId","stop","setStop","textFieldValue","setTextFieldValue","textFieldValueOld","setTextFieldValueOld","textFieldValue1","setTextFieldValue1","textFieldValueOld1","setTextFieldValueOld1","loading","error","data","first","setFirst","handleTextFieldChange","value","test","handleTextFieldChange1","active","setActive","toastMarkup","zIndex","message","sURL","String","shop","myshopifyDomain","substr","length","get","then","result","serverID","channelID","console","log","scriptTags","edges","undefined","variables","input","src","displayScope","refetchQueries","query","makeApiCall","alert","appInfo","url","post","response"],"mappings":"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","sourcesContent":["import {\r\n  Button,\r\n  Card,\r\n  Layout,\r\n  Page,\r\n  Stack,\r\n  TextField,\r\n  Banner,\r\n  Frame,\r\n  Toast,\r\n} from '@shopify/polaris';\r\nimport gql from 'graphql-tag'\r\nimport React, { useState, useCallback } from 'react';\r\nimport { useQuery, useMutation } from '@apollo/react-hooks';\r\nimport axios from 'axios';\r\nimport Cookies from 'js-cookie';\r\n\r\nconst CREATE_SCRIPTTAG = gql`\r\n    mutation scriptTagCreate($input: ScriptTagInput!) {\r\n        scriptTagCreate(input: $input) {\r\n           scriptTag {\r\n             id\r\n            }\r\n           userErrors {\r\n            field\r\n            message\r\n            }\r\n        }\r\n    }\r\n`\r\n\r\nconst GET_STORE = gql`\r\n  query getStore{ \r\n    scriptTags(first: 5) {\r\n      edges {\r\n          node {\r\n              id\r\n              src\r\n              displayScope\r\n          }\r\n      }\r\n  }\r\n\r\n    shop { \r\n      myshopifyDomain \r\n    }      \r\n  }\r\n`\r\n\r\nconst urlScriptTags = `https://0fb87c6bfac1.ngrok.io/test-script.js`;\r\n\r\nfunction AnnotatedLayout() {\r\n  const [createScripts] = useMutation(CREATE_SCRIPTTAG);\r\n  const [idset, setId] = useState(false);\r\n  const [stop, setStop] = useState(true);\r\n  const [textFieldValue, setTextFieldValue] = useState('');\r\n  const [textFieldValueOld, setTextFieldValueOld] = useState('');\r\n  const [textFieldValue1, setTextFieldValue1] = useState('');\r\n  const [textFieldValueOld1, setTextFieldValueOld1] = useState('');\r\n  const { loading, error, data } = useQuery(GET_STORE);\r\n  const [first, setFirst] = useState(true);\r\n\r\n  const handleTextFieldChange = useCallback(\r\n    (value) => {\r\n      if (/^\\d+$/.test(value) || value == '')\r\n        setTextFieldValue(value);\r\n      //console.log(textFieldValue);\r\n    },\r\n    [],\r\n  );\r\n\r\n  const handleTextFieldChange1 = useCallback(\r\n    (value) => {\r\n      if (/^\\d+$/.test(value) || value == '')\r\n        setTextFieldValue1(value);\r\n      //console.log(textFieldValue1);\r\n    },\r\n    [],\r\n  );\r\n\r\n  //toast\r\n  const [active, setActive] = useState(false);\r\n\r\n  const toastMarkup = active ? (\r\n    <div style={{ zIndex: '999' }}>\r\n      <Toast content=\"Settings Saved\" onDismiss={() => { setActive(!active) }} />\r\n    </div>\r\n  ) : null;\r\n\r\n  if (loading) return <div>Loading..</div>\r\n  else if (error) {\r\n    //console.log(Cookies.get(\"shopOrigin\"));\r\n    //location.replace(`https://discord-shopify-app.herokuapp.com/auth?shop=${Cookies.get(\"shopOrigin\")}`)\r\n    return <div>{error.message}</div>\r\n  }\r\n\r\n  // console.log(data.priceRules.edges[0].node.discountCodes.edges[0].node.id);\r\n  // console.log(data.priceRules.edges[0].node.discountCodes.edges[0].node.code);\r\n  //console.log(Cookie.get(\"shopOrigin\"))\r\n\r\n  const sURL = String(data.shop.myshopifyDomain).substr(0, String(data.shop.myshopifyDomain).length - 14)\r\n\r\n  if (first) {\r\n    axios.get(`/api/discordID/${sURL}`).then(result => {\r\n      if (result.data.data.serverID != null) {\r\n        setId(true);\r\n        setTextFieldValue(result.data.data.serverID);\r\n        setTextFieldValue1(result.data.data.channelID);\r\n        setTextFieldValueOld(result.data.data.serverID);\r\n        setTextFieldValueOld1(result.data.data.channelID);\r\n      }\r\n    }).catch(error => console.log(error));\r\n\r\n    setFirst(false);\r\n  }\r\n\r\n  if (stop && data.scriptTags.edges[0] == undefined) {\r\n    console.log(\"dublu cacat\")\r\n    setStop(false);\r\n    createScripts({\r\n      variables: {\r\n        input: {\r\n          src: urlScriptTags,\r\n          displayScope: \"ALL\"\r\n        }\r\n      },\r\n      refetchQueries: [{ query: GET_STORE }]\r\n    })\r\n  }\r\n\r\n  return (\r\n    <Frame>\r\n      <Page title=\"Discordify Server/Channel ID\" >\r\n        <Layout>\r\n          {toastMarkup}\r\n          <Layout.Section >\r\n            <Banner\r\n              status={(idset) ? \"success\" : \"critical\"}\r\n              title={(idset) ? \"Server/Channel ID Set\" : \"No Server/Channel ID Set\"}\r\n            >\r\n            </Banner>\r\n          </Layout.Section>\r\n          <Layout.AnnotatedSection title=\"Step One\" description={<p>Add Widgetbot to your server <a href=\"https://discord.com/oauth2/authorize?client_id=543225764036870167&scope=bot&permissions=537218112\" target=\"_blank\"><b>here</b></a>. Make sure you give Widgetbot all the permissions!</p>}>\r\n            <Card sectioned >\r\n              <img src=\"dis1.PNG\" width=\"100%\" height=\"410\" />\r\n            </Card>\r\n          </Layout.AnnotatedSection>\r\n          <Layout.AnnotatedSection title=\"Step Two\" description=\"Type the ??guestmode command if you want people who don't have a discord account or are not already in your server to be able to choose a name on spot and write messages. Type ??help for a full list of commands.\">\r\n            <Card sectioned >\r\n              <img src=\"dis2.PNG\" width=\"100%\" height=\"410\" />\r\n            </Card>\r\n          </Layout.AnnotatedSection>\r\n          <Layout.AnnotatedSection title=\"Step Three\" description='Type the ??crate command in the text channel you want to display in the widget after it loads. Copy the values from Server and Channel without the quotes, paste them bellow and submit. You can always come back here to change the IDs'>\r\n            < Card sectioned >\r\n              <img src=\"dis3.PNG\" width=\"100%\" height=\"410\" />\r\n            </Card>\r\n          </Layout.AnnotatedSection>\r\n          <Layout.Section>\r\n            <Card sectioned>\r\n              <Stack spacing=\"extraLoose\">\r\n                <Stack.Item fill>\r\n                  <TextField\r\n                    label=\"Server ID\"\r\n                    placeholder=\"Paste your Discord Server ID here\"\r\n                    value={textFieldValue}\r\n                    onChange={handleTextFieldChange}\r\n                  >\r\n                  </TextField>\r\n                </Stack.Item>\r\n              </Stack>\r\n              <br />\r\n              <Stack spacing=\"extraLoose\">\r\n                <Stack.Item fill>\r\n                  <TextField\r\n                    label=\"Channel ID\"\r\n                    placeholder=\"Paste your Discord Channel ID here\"\r\n                    value={textFieldValue1}\r\n                    onChange={handleTextFieldChange1}\r\n                  >\r\n                  </TextField>\r\n                </Stack.Item>\r\n              </Stack>\r\n              <br />\r\n              <Stack distribution=\"trailing\">\r\n                <Button\r\n                  primary\r\n                  disabled={((textFieldValue == '' || textFieldValueOld == textFieldValue) && (textFieldValue1 == '' || textFieldValueOld1 == textFieldValue1)) ? true : false}\r\n                  type=\"submit\"\r\n                  onClick={() => {\r\n                    if (textFieldValue != '') {\r\n                      setId(true);\r\n                      setActive(true);\r\n                      makeApiCall({ serverID: textFieldValue, channelID: textFieldValue1 }, sURL);\r\n                    }\r\n                    else {\r\n                      alert(\"Please paste in your ID first\");\r\n                    }\r\n                  }}>\r\n                  Submit\r\n                </Button>\r\n              </Stack>\r\n            </Card>\r\n          </Layout.Section>\r\n        </Layout>\r\n      </Page >\r\n    </Frame>\r\n  )\r\n\r\n  async function makeApiCall(appInfo, sURL) {\r\n    const url = `/api/discordID/${sURL}`;\r\n    setTextFieldValueOld(textFieldValue);\r\n    setTextFieldValueOld1(textFieldValue1);\r\n    axios.post(url, appInfo).then((result) => { }).catch((error) => { console.log(error.response) });\r\n  }\r\n}\r\n\r\nexport default AnnotatedLayout;"]},"metadata":{},"sourceType":"module"}